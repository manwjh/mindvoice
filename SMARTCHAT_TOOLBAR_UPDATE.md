# SmartChat 底部工具栏优化

## 更新时间
2026-01-06

## 更新内容

### 1. 设计目标
参考 VoiceNote 的 BottomToolbar 布局，为 SmartChat 实现统一的集中栏设计。

### 2. 布局结构

#### 顶部工具栏（Top Toolbar）
- **位置**: 页面顶部
- **内容**: 只放 EXIT 按钮
- **对齐方式**: 右对齐
- **功能**: 退出当前对话会话

#### 底部集中栏（Bottom Toolbar）
采用悬浮圆角容器设计，包含两行内容：

**第一行（工具栏）**:
- 📚 知识库开关（checkbox）
- 🗑️ 清空按钮
- 可横向滚动，隐藏滚动条
- 无底色按钮样式，统一视觉效果

**第二行（操作区）**:
- 📝 输入框（左侧，flex: 1）
- ｜ 分隔线
- 🎤 语音输入按钮（中间，圆形按钮）
- ｜ 分隔线
- ➕ NEW 按钮（右侧，圆形按钮）

### 3. 视觉特点

#### 悬浮容器
- 圆角: 16px
- 阴影: 多层阴影，悬浮效果
- 背景: 毛玻璃效果（backdrop-filter）
- 边框: 1px 细边框
- Hover 效果: 增强阴影

#### 按钮样式
**工具栏按钮**:
- 透明背景
- 1px 边框
- 紧凑间距（6px 12px）
- Hover 时显示背景色

**ASR 语音按钮**:
- 大小: 56px × 56px（桌面），响应式缩小
- 启动状态: 透明背景 + 绿色轮廓麦克风
- 录音状态: 红色渐变背景 + 白色实心麦克风
- 停止中: 黄色渐变背景 + 脉动动画

**NEW 按钮**:
- 圆形按钮（48px × 48px）
- 透明背景 + 边框
- Hover 时背景色 + 主题色边框

#### 输入框
- 背景: 次要背景色
- 边框: 2px，focus 时显示主题色
- 圆角: 中等（var(--radius-md)）
- 最小高度: 48px
- 最大高度: 100px（可滚动）
- 录音时: 红色边框 + 红色阴影

### 4. 响应式设计

#### 桌面端（>768px）
- 完整布局
- ASR 按钮: 56px
- NEW 按钮: 48px
- 间距: 标准（12px）

#### 平板端（≤768px）
- 布局紧凑
- ASR 按钮: 48px
- NEW 按钮: 44px
- 间距: 缩小（8px）

#### 移动端（≤480px）
- 最小化布局
- ASR 按钮: 44px
- NEW 按钮: 40px
- 间距: 最小（6px）
- 字体和内边距进一步缩小

### 5. 功能实现

#### NEW 按钮功能
```typescript
onClick={() => {
  setMessages([]);      // 清空消息列表
  setInputText('');     // 清空输入框
}}
```
- 开始新一轮对话
- 仅在 ASR 空闲且有消息时启用
- 不调用后端清空历史接口（保留历史记录）

#### 知识库开关
- 位置: 移到底部工具栏第一行
- 样式: 统一为透明背景 + 边框
- 状态: 默认开启（useKnowledge = true）

#### 清空按钮
- 位置: 移到底部工具栏第一行
- 功能: 清空后端对话历史
- 禁用条件: messages.length === 0

### 6. 代码变更

#### SmartChat.tsx
1. 导入 Icon 组件
2. 简化顶部工具栏，只保留 EXIT 按钮
3. 重构底部工具栏，实现集中栏布局
4. 添加 NEW 按钮功能

#### SmartChat.css
1. 更新顶部工具栏样式（右对齐）
2. 删除旧的底部工具栏样式
3. 添加集中栏容器样式
4. 实现横向滚动工具栏
5. 优化 ASR 按钮样式（减小尺寸）
6. 添加分隔线样式
7. 完善响应式设计

### 7. 与 VoiceNote 的一致性

#### 相同点
✅ 悬浮圆角容器设计
✅ 两行布局结构
✅ ASR 按钮样式和动画
✅ 无底色工具栏按钮
✅ 响应式设计策略

#### 不同点
- VoiceNote 第一行: 语言选择器 + 复制 + 小结 + 导出
- SmartChat 第一行: 知识库开关 + 清空

- VoiceNote 第二行: 录音按钮（居中）+ NEW 按钮
- SmartChat 第二行: 输入框 + 录音按钮 + NEW 按钮

### 8. 用户体验提升

1. **视觉统一**: 与 VoiceNote 保持一致的设计语言
2. **操作便捷**: 所有控制集中在底部，减少视线移动
3. **布局清晰**: 分隔线明确区分功能区域
4. **反馈及时**: Hover、Focus、Recording 状态明确
5. **响应灵敏**: 全尺寸屏幕优化，移动端友好

### 9. 测试建议

- [ ] 测试桌面端布局和交互
- [ ] 测试平板端响应式布局
- [ ] 测试移动端布局和触摸操作
- [ ] 测试 ASR 按钮状态切换
- [ ] 测试 NEW 按钮功能
- [ ] 测试知识库开关功能
- [ ] 测试清空按钮功能
- [ ] 测试 EXIT 按钮功能
- [ ] 测试输入框 Enter 发送、Shift+Enter 换行
- [ ] 测试不同主题（浅色/深色）下的视觉效果

### 10. 后续优化方向

1. **动画效果**: 添加工具栏展开/收起动画
2. **快捷键**: 为常用功能添加键盘快捷键
3. **语音提示**: 录音状态的音效反馈
4. **手势支持**: 移动端滑动操作
5. **智能建议**: 输入框的智能补全

---

## 总结

本次更新成功将 SmartChat 的底部工具栏改造为与 VoiceNote 一致的集中栏设计，提升了视觉一致性和用户体验。新布局更加简洁、高效，功能分区清晰，适配全尺寸屏幕。

**关键成果**:
- ✅ 统一的设计语言
- ✅ 优雅的悬浮容器
- ✅ 完善的响应式设计
- ✅ 无 linter 错误
- ✅ 代码结构清晰

